# from odoo.addons.hijri_date_util.models.hijri_date import HijriDate
from odoo.addons.hijri_date_util.models.hijri_date import HijriDate
from datetime import date
from datetime import timedelta

month_ending={'127001':30,'127002':29,'127003':30,'127004':29,'127005':30,'127006':29,'127007':30,'127008':29,'127009':30,'127010':29,
'127011':30,'127012':30,'127101':30,'127102':29,'127103':30,'127104':29,'127105':30,'127106':29,'127107':30,'127108':29,
'127109':30,'127110':29,'127111':30,'127112':29,'127201':30,'127202':29,'127203':30,'127204':29,'127205':30,'127206':29,
'127207':30,'127208':29,'127209':30,'127210':29,'127211':30,'127212':29,'127301':30,'127302':29,'127303':30,'127304':29,
'127305':30,'127306':29,'127307':30,'127308':29,'127309':30,'127310':29,'127311':30,'127312':29,'127401':30,'127402':29,
'127403':30,'127404':29,'127405':30,'127406':29,'127407':30,'127408':29,'127409':30,'127410':29,'127411':30,'127412':30,
'127501':30,'127502':29,'127503':30,'127504':29,'127505':30,'127506':29,'127507':30,'127508':29,'127509':30,'127510':29,
'127511':30,'127512':29,'127601':30,'127602':29,'127603':30,'127604':29,'127605':30,'127606':29,'127607':30,'127608':29,
'127609':30,'127610':29,'127611':30,'127612':30,'127701':30,'127702':29,'127703':30,'127704':29,'127705':30,'127706':29,
'127707':30,'127708':29,'127709':30,'127710':29,'127711':30,'127712':29,'127801':30,'127802':29,'127803':30,'127804':29,
'127805':30,'127806':29,'127807':30,'127808':29,'127809':30,'127810':29,'127811':30,'127812':30,'127901':30,'127902':29,
'127903':30,'127904':29,'127905':30,'127906':29,'127907':30,'127908':29,'127909':30,'127910':29,'127911':30,'127912':29,
'128001':30,'128002':29,'128003':30,'128004':29,'128005':30,'128006':29,'128007':30,'128008':29,'128009':30,'128010':29,
'128011':30,'128012':29,'128101':30,'128102':29,'128103':30,'128104':29,'128105':30,'128106':29,'128107':30,'128108':29,
'128109':30,'128110':29,'128111':30,'128112':29,'128201':30,'128202':29,'128203':30,'128204':29,'128205':30,'128206':29,
'128207':30,'128208':29,'128209':30,'128210':29,'128211':30,'128212':30,'128301':30,'128302':29,'128303':30,'128304':29,
'128305':30,'128306':29,'128307':30,'128308':29,'128309':30,'128310':29,'128311':30,'128312':30,'128401':30,'128402':29,
'128403':30,'128404':29,'128405':30,'128406':29,'128407':30,'128408':29,'128409':30,'128410':29,'128411':30,'128412':29,
'128501':30,'128502':29,'128503':30,'128504':29,'128505':30,'128506':29,'128507':30,'128508':29,'128509':30,'128510':29,
'128511':30,'128512':29,'128601':30,'128602':29,'128603':30,'128604':29,'128605':30,'128606':29,'128607':30,'128608':29,
'128609':30,'128610':29,'128611':30,'128612':29,'128701':30,'128702':29,'128703':30,'128704':29,'128705':30,'128706':29,
'128707':30,'128708':29,'128709':30,'128710':29,'128711':30,'128712':30,'128801':30,'128802':29,'128803':30,'128804':29,
'128805':30,'128806':29,'128807':30,'128808':29,'128809':30,'128810':29,'128811':30,'128812':29,'128901':30,'128902':29,
'128903':30,'128904':29,'128905':30,'128906':29,'128907':30,'128908':29,'128909':30,'128910':29,'128911':30,'128912':30,
'129001':30,'129002':29,'129003':30,'129004':29,'129005':30,'129006':29,'129007':30,'129008':29,'129009':30,'129010':29,
'129011':30,'129012':29,'129101':30,'129102':29,'129103':30,'129104':29,'129105':30,'129106':29,'129107':30,'129108':29,
'129109':30,'129110':29,'129111':30,'129112':30,'129201':30,'129202':29,'129203':30,'129204':29,'129205':30,'129206':29,
'129207':30,'129208':29,'129209':30,'129210':29,'129211':30,'129212':29,'129301':30,'129302':29,'129303':30,'129304':29,
'129305':30,'129306':29,'129307':30,'129308':29,'129309':30,'129310':29,'129311':30,'129312':29,'129401':30,'129402':29,
'129403':30,'129404':29,'129405':30,'129406':29,'129407':30,'129408':29,'129409':30,'129410':29,'129411':30,'129412':29,
'129501':30,'129502':29,'129503':30,'129504':29,'129505':30,'129506':29,'129507':30,'129508':29,'129509':30,'129510':29,
'129511':30,'129512':29,'129601':30,'129602':29,'129603':30,'129604':29,'129605':30,'129606':29,'129607':30,'129608':29,
'129609':30,'129610':29,'129611':30,'129612':30,'129701':30,'129702':29,'129703':30,'129704':29,'129705':30,'129706':29,
'129707':30,'129708':29,'129709':30,'129710':29,'129711':30,'129712':29,'129801':30,'129802':29,'129803':30,'129804':29,
'129805':30,'129806':29,'129807':30,'129808':29,'129809':30,'129810':29,'129811':30,'129812':30,'129901':30,'129902':29,
'129903':30,'129904':29,'129905':30,'129906':29,'129907':30,'129908':29,'129909':30,'129910':29,'129911':30,'129912':29,
'130001':30,'130002':29,'130003':30,'130004':29,'130005':30,'130006':29,'130007':30,'130008':29,'130009':30,'130010':29,
'130011':30,'130012':29,'130101':30,'130102':29,'130103':30,'130104':29,'130105':30,'130106':29,'130107':30,'130108':29,
'130109':30,'130110':29,'130111':30,'130112':29,'130201':30,'130202':29,'130203':30,'130204':29,'130205':30,'130206':29,
'130207':30,'130208':29,'130209':30,'130210':29,'130211':30,'130212':30,'130301':30,'130302':29,'130303':30,'130304':29,
'130305':30,'130306':29,'130307':30,'130308':29,'130309':30,'130310':29,'130311':30,'130312':29,'130401':30,'130402':29,
'130403':30,'130404':29,'130405':30,'130406':29,'130407':30,'130408':29,'130409':30,'130410':29,'130411':30,'130412':30,
'130501':30,'130502':29,'130503':30,'130504':29,'130505':30,'130506':29,'130507':30,'130508':29,'130509':30,'130510':29,
'130511':30,'130512':30,'130601':30,'130602':29,'130603':30,'130604':29,'130605':30,'130606':29,'130607':30,'130608':29,
'130609':30,'130610':29,'130611':30,'130612':29,'130701':30,'130702':29,'130703':30,'130704':29,'130705':30,'130706':29,
'130707':30,'130708':29,'130709':30,'130710':29,'130711':30,'130712':29,'130801':30,'130802':29,'130803':30,'130804':29,
'130805':30,'130806':29,'130807':30,'130808':29,'130809':30,'130810':29,'130811':30,'130812':29,'130901':30,'130902':29,
'130903':30,'130904':29,'130905':30,'130906':29,'130907':30,'130908':29,'130909':30,'130910':29,'130911':30,'130912':29,
'131001':30,'131002':29,'131003':30,'131004':29,'131005':30,'131006':29,'131007':30,'131008':29,'131009':30,'131010':29,
'131011':30,'131012':30,'131101':30,'131102':29,'131103':30,'131104':29,'131105':30,'131106':29,'131107':30,'131108':29,
'131109':30,'131110':29,'131111':30,'131112':30,'131201':30,'131202':29,'131203':30,'131204':29,'131205':30,'131206':29,
'131207':30,'131208':29,'131209':30,'131210':29,'131211':30,'131212':29,'131301':30,'131302':29,'131303':30,'131304':29,
'131305':30,'131306':29,'131307':30,'131308':29,'131309':30,'131310':29,'131311':30,'131312':30,'131401':30,'131402':29,
'131403':30,'131404':29,'131405':30,'131406':29,'131407':30,'131408':29,'131409':30,'131410':29,'131411':30,'131412':29,
'131501':30,'131502':29,'131503':30,'131504':29,'131505':30,'131506':29,'131507':30,'131508':29,'131509':30,'131510':29,
'131511':30,'131512':29,'131601':30,'131602':29,'131603':30,'131604':29,'131605':30,'131606':29,'131607':30,'131608':29,
'131609':30,'131610':29,'131611':30,'131612':29,'131701':30,'131702':29,'131703':30,'131704':29,'131705':30,'131706':29,
'131707':30,'131708':29,'131709':30,'131710':29,'131711':30,'131712':29,'131801':30,'131802':29,'131803':30,'131804':29,
'131805':30,'131806':29,'131807':30,'131808':29,'131809':30,'131810':29,'131811':30,'131812':29,'131901':30,'131902':29,
'131903':29,'131904':30,'131905':29,'131906':30,'131907':30,'131908':30,'131909':29,'131910':30,'131911':30,'131912':29,
'132001':29,'132002':30,'132003':29,'132004':29,'132005':30,'132006':29,'132007':30,'132008':30,'132009':29,'132010':30,
'132011':30,'132012':30,'132101':29,'132102':29,'132103':30,'132104':29,'132105':29,'132106':30,'132107':29,'132108':30,
'132109':29,'132110':30,'132111':30,'132112':30,'132201':29,'132202':30,'132203':29,'132204':30,'132205':29,'132206':29,
'132207':30,'132208':29,'132209':30,'132210':29,'132211':30,'132212':30,'132301':29,'132302':30,'132303':30,'132304':29,
'132305':30,'132306':29,'132307':29,'132308':30,'132309':29,'132310':30,'132311':29,'132312':30,'132401':29,'132402':30,
'132403':30,'132404':29,'132405':30,'132406':30,'132407':29,'132408':29,'132409':30,'132410':29,'132411':30,'132412':29,
'132501':30,'132502':29,'132503':30,'132504':29,'132505':30,'132506':30,'132507':29,'132508':30,'132509':29,'132510':30,
'132511':29,'132512':30,'132601':29,'132602':30,'132603':29,'132604':30,'132605':29,'132606':30,'132607':29,'132608':30,
'132609':30,'132610':29,'132611':30,'132612':30,'132701':29,'132702':29,'132703':30,'132704':29,'132705':29,'132706':30,
'132707':29,'132708':30,'132709':30,'132710':30,'132711':29,'132712':30,'132801':30,'132802':29,'132803':29,'132804':30,
'132805':29,'132806':29,'132807':30,'132808':29,'132809':30,'132810':30,'132811':29,'132812':30,'132901':30,'132902':30,
'132903':29,'132904':29,'132905':30,'132906':29,'132907':29,'132908':30,'132909':29,'132910':30,'132911':29,'132912':30,
'133001':30,'133002':30,'133003':29,'133004':30,'133005':29,'133006':30,'133007':29,'133008':29,'133009':30,'133010':29,
'133011':30,'133012':29,'133101':30,'133102':30,'133103':30,'133104':29,'133105':30,'133106':29,'133107':30,'133108':29,
'133109':29,'133110':30,'133111':29,'133112':30,'133201':29,'133202':30,'133203':30,'133204':29,'133205':30,'133206':30,
'133207':29,'133208':30,'133209':29,'133210':29,'133211':30,'133212':29,'133301':30,'133302':29,'133303':30,'133304':29,
'133305':30,'133306':30,'133307':29,'133308':30,'133309':29,'133310':30,'133311':29,'133312':30,'133401':29,'133402':30,
'133403':29,'133404':30,'133405':29,'133406':30,'133407':29,'133408':30,'133409':30,'133410':29,'133411':30,'133412':29,
'133501':30,'133502':29,'133503':30,'133504':29,'133505':30,'133506':29,'133507':30,'133508':29,'133509':30,'133510':29,
'133511':30,'133512':30,'133601':29,'133602':30,'133603':29,'133604':30,'133605':29,'133606':30,'133607':29,'133608':29,
'133609':30,'133610':29,'133611':30,'133612':30,'133701':29,'133702':30,'133703':30,'133704':29,'133705':30,'133706':29,
'133707':30,'133708':29,'133709':29,'133710':30,'133711':29,'133712':30,'133801':29,'133802':30,'133803':30,'133804':30,
'133805':29,'133806':30,'133807':29,'133808':30,'133809':29,'133810':29,'133811':30,'133812':29,'133901':30,'133902':29,
'133903':30,'133904':30,'133905':30,'133906':29,'133907':30,'133908':29,'133909':30,'133910':29,'133911':29,'133912':30,
'134001':29,'134002':29,'134003':30,'134004':30,'134005':29,'134006':30,'134007':30,'134008':30,'134009':29,'134010':30,
'134011':29,'134012':29,'134101':30,'134102':29,'134103':30,'134104':29,'134105':30,'134106':29,'134107':30,'134108':30,
'134109':29,'134110':30,'134111':30,'134112':29,'134201':29,'134202':30,'134203':29,'134204':30,'134205':29,'134206':30,
'134207':29,'134208':30,'134209':29,'134210':30,'134211':30,'134212':29,'134301':30,'134302':29,'134303':30,'134304':29,
'134305':30,'134306':29,'134307':30,'134308':29,'134309':30,'134310':29,'134311':30,'134312':29,'134401':30,'134402':30,
'134403':29,'134404':30,'134405':29,'134406':30,'134407':29,'134408':30,'134409':29,'134410':29,'134411':30,'134412':29,
'134501':30,'134502':30,'134503':29,'134504':30,'134505':30,'134506':29,'134507':30,'134508':29,'134509':30,'134510':29,
'134511':29,'134512':30,'134601':29,'134602':30,'134603':29,'134604':30,'134605':30,'134606':30,'134607':29,'134608':30,
'134609':29,'134610':30,'134611':29,'134612':29,'134701':30,'134702':29,'134703':30,'134704':29,'134705':30,'134706':30,
'134707':30,'134708':29,'134709':30,'134710':29,'134711':30,'134712':29,'134801':29,'134802':30,'134803':29,'134804':29,
'134805':30,'134806':30,'134807':29,'134808':30,'134809':30,'134810':30,'134811':29,'134812':30,'134901':29,'134902':29,
'134903':30,'134904':29,'134905':29,'134906':30,'134907':30,'134908':29,'134909':30,'134910':30,'134911':30,'134912':29,
'135001':30,'135002':29,'135003':29,'135004':30,'135005':29,'135006':29,'135007':30,'135008':29,'135009':30,'135010':30,
'135011':30,'135012':29,'135101':30,'135102':29,'135103':30,'135104':29,'135105':30,'135106':29,'135107':30,'135108':29,
'135109':29,'135110':30,'135111':30,'135112':29,'135201':30,'135202':30,'135203':29,'135204':30,'135205':29,'135206':30,
'135207':29,'135208':30,'135209':29,'135210':30,'135211':29,'135212':29,'135301':30,'135302':30,'135303':29,'135304':30,
'135305':30,'135306':29,'135307':30,'135308':29,'135309':30,'135310':29,'135311':30,'135312':29,'135401':29,'135402':30,
'135403':29,'135404':30,'135405':30,'135406':29,'135407':30,'135408':30,'135409':29,'135410':30,'135411':29,'135412':30,
'135501':29,'135502':29,'135503':30,'135504':29,'135505':30,'135506':29,'135507':30,'135508':30,'135509':29,'135510':30,
'135511':30,'135512':29,'135601':30,'135602':29,'135603':29,'135604':30,'135605':29,'135606':29,'135607':30,'135608':30,
'135609':29,'135610':30,'135611':30,'135612':30,'135701':29,'135702':30,'135703':29,'135704':29,'135705':30,'135706':29,
'135707':29,'135708':30,'135709':30,'135710':29,'135711':30,'135712':30,'135801':30,'135802':29,'135803':30,'135804':29,
'135805':29,'135806':30,'135807':29,'135808':29,'135809':30,'135810':29,'135811':30,'135812':30,'135901':30,'135902':29,
'135903':30,'135904':30,'135905':29,'135906':29,'135907':30,'135908':29,'135909':29,'135910':30,'135911':29,'135912':30,
'136001':30,'136002':29,'136003':30,'136004':30,'136005':29,'136006':30,'136007':29,'136008':30,'136009':29,'136010':30,
'136011':29,'136012':29,'136101':30,'136102':29,'136103':30,'136104':30,'136105':29,'136106':30,'136107':30,'136108':29,
'136109':30,'136110':29,'136111':30,'136112':29,'136201':29,'136202':30,'136203':29,'136204':30,'136205':29,'136206':30,
'136207':30,'136208':29,'136209':30,'136210':30,'136211':29,'136212':30,'136301':29,'136302':30,'136303':29,'136304':29,
'136305':30,'136306':29,'136307':30,'136308':29,'136309':30,'136310':30,'136311':29,'136312':30,'136401':30,'136402':29,
'136403':30,'136404':29,'136405':29,'136406':30,'136407':29,'136408':30,'136409':29,'136410':30,'136411':29,'136412':30,
'136501':30,'136502':30,'136503':29,'136504':30,'136505':29,'136506':29,'136507':30,'136508':29,'136509':29,'136510':30,
'136511':29,'136512':30,'136601':30,'136602':30,'136603':30,'136604':29,'136605':30,'136606':29,'136607':29,'136608':30,
'136609':29,'136610':29,'136611':30,'136612':29,'136701':30,'136702':30,'136703':30,'136704':29,'136705':30,'136706':30,
'136707':29,'136708':29,'136709':30,'136710':29,'136711':29,'136712':30,'136801':29,'136802':30,'136803':30,'136804':29,
'136805':30,'136806':30,'136807':29,'136808':30,'136809':29,'136810':30,'136811':29,'136812':29,'136901':30,'136902':29,
'136903':30,'136904':29,'136905':30,'136906':30,'136907':30,'136908':29,'136909':30,'136910':29,'136911':30,'136912':29,
'137001':29,'137002':30,'137003':29,'137004':30,'137005':29,'137006':30,'137007':30,'137008':29,'137009':30,'137010':29,
'137011':30,'137012':30,'137101':29,'137102':30,'137103':29,'137104':29,'137105':30,'137106':29,'137107':30,'137108':29,
'137109':30,'137110':29,'137111':30,'137112':30,'137201':29,'137202':30,'137203':30,'137204':29,'137205':30,'137206':29,
'137207':29,'137208':30,'137209':29,'137210':30,'137211':29,'137212':30,'137301':30,'137302':29,'137303':30,'137304':30,
'137305':29,'137306':30,'137307':29,'137308':29,'137309':30,'137310':29,'137311':29,'137312':30,'137401':30,'137402':29,
'137403':30,'137404':30,'137405':30,'137406':29,'137407':30,'137408':29,'137409':29,'137410':30,'137411':29,'137412':29,
'137501':30,'137502':29,'137503':30,'137504':30,'137505':30,'137506':29,'137507':30,'137508':30,'137509':29,'137510':29,
'137511':30,'137512':29,'137601':29,'137602':30,'137603':29,'137604':30,'137605':30,'137606':29,'137607':30,'137608':30,
'137609':29,'137610':30,'137611':29,'137612':30,'137701':29,'137702':29,'137703':30,'137704':29,'137705':30,'137706':29,
'137707':30,'137708':30,'137709':30,'137710':29,'137711':30,'137712':29,'137801':30,'137802':29,'137803':29,'137804':30,
'137805':29,'137806':30,'137807':29,'137808':30,'137809':30,'137810':29,'137811':30,'137812':30,'137901':29,'137902':30,
'137903':29,'137904':29,'137905':30,'137906':29,'137907':30,'137908':29,'137909':30,'137910':29,'137911':30,'137912':30,
'138001':29,'138002':30,'138003':29,'138004':30,'138005':29,'138006':30,'138007':29,'138008':30,'138009':29,'138010':30,
'138011':29,'138012':30,'138101':29,'138102':30,'138103':30,'138104':29,'138105':30,'138106':29,'138107':30,'138108':30,
'138109':29,'138110':29,'138111':30,'138112':29,'138201':29,'138202':30,'138203':30,'138204':29,'138205':30,'138206':30,
'138207':29,'138208':30,'138209':30,'138210':29,'138211':29,'138212':30,'138301':29,'138302':29,'138303':30,'138304':29,
'138305':30,'138306':30,'138307':30,'138308':29,'138309':30,'138310':30,'138311':29,'138312':29,'138401':30,'138402':29,
'138403':29,'138404':30,'138405':29,'138406':30,'138407':30,'138408':29,'138409':30,'138410':30,'138411':30,'138412':29,
'138501':29,'138502':30,'138503':29,'138504':29,'138505':30,'138506':29,'138507':30,'138508':29,'138509':30,'138510':30,
'138511':30,'138512':29,'138601':30,'138602':29,'138603':30,'138604':29,'138605':29,'138606':30,'138607':29,'138608':30,
'138609':29,'138610':30,'138611':30,'138612':29,'138701':30,'138702':30,'138703':29,'138704':30,'138705':29,'138706':29,
'138707':30,'138708':29,'138709':30,'138710':29,'138711':30,'138712':29,'138801':30,'138802':30,'138803':29,'138804':30,
'138805':29,'138806':30,'138807':29,'138808':30,'138809':29,'138810':30,'138811':29,'138812':30,'138901':29,'138902':30,
'138903':29,'138904':30,'138905':30,'138906':29,'138907':30,'138908':29,'138909':30,'138910':29,'138911':30,'138912':29,
'139001':30,'139002':29,'139003':30,'139004':29,'139005':30,'139006':29,'139007':30,'139008':30,'139009':29,'139010':30,
'139011':29,'139012':30,'139101':29,'139102':30,'139103':29,'139104':29,'139105':30,'139106':29,'139107':30,'139108':30,
'139109':30,'139110':29,'139111':30,'139112':30,'139201':29,'139202':29,'139203':30,'139204':29,'139205':29,'139206':30,
'139207':29,'139208':30,'139209':30,'139210':29,'139211':30,'139212':30,'139301':30,'139302':29,'139303':29,'139304':30,
'139305':29,'139306':29,'139307':30,'139308':29,'139309':30,'139310':29,'139311':30,'139312':30,'139401':30,'139402':29,
'139403':30,'139404':29,'139405':30,'139406':29,'139407':29,'139408':30,'139409':29,'139410':30,'139411':29,'139412':30,
'139501':30,'139502':29,'139503':30,'139504':30,'139505':29,'139506':30,'139507':29,'139508':29,'139509':30,'139510':29,
'139511':30,'139512':29,'139601':30,'139602':29,'139603':30,'139604':30,'139605':30,'139606':29,'139607':30,'139608':29,
'139609':29,'139610':30,'139611':29,'139612':30,'139701':29,'139702':30,'139703':29,'139704':30,'139705':30,'139706':29,
'139707':30,'139708':29,'139709':30,'139710':29,'139711':30,'139712':29,'139801':30,'139802':29,'139803':30,'139804':29,
'139805':30,'139806':29,'139807':30,'139808':30,'139809':29,'139810':30,'139811':29,'139812':30,'139901':29,'139902':30,
'139903':29,'139904':30,'139905':29,'139906':30,'139907':29,'139908':30,'139909':29,'139910':30,'139911':30,'139912':29,
'140001':30,'140002':29,'140003':30,'140004':29,'140005':30,'140006':29,'140007':29,'140008':30,'140009':29,'140010':30,
'140011':30,'140012':29,'140101':30,'140102':30,'140103':29,'140104':30,'140105':29,'140106':30,'140107':29,'140108':29,
'140109':30,'140110':29,'140111':30,'140112':29,'140201':30,'140202':30,'140203':30,'140204':29,'140205':30,'140206':29,
'140207':30,'140208':29,'140209':29,'140210':30,'140211':29,'140212':30,'140301':29,'140302':30,'140303':30,'140304':30,
'140305':29,'140306':30,'140307':29,'140308':30,'140309':29,'140310':29,'140311':30,'140312':29,'140401':29,'140402':30,
'140403':30,'140404':29,'140405':30,'140406':30,'140407':30,'140408':29,'140409':30,'140410':29,'140411':29,'140412':30,
'140501':29,'140502':29,'140503':30,'140504':30,'140505':29,'140506':30,'140507':30,'140508':29,'140509':30,'140510':29,
'140511':30,'140512':29,'140601':30,'140602':29,'140603':30,'140604':29,'140605':30,'140606':29,'140607':30,'140608':29,
'140609':30,'140610':30,'140611':29,'140612':30,'140701':29,'140702':30,'140703':29,'140704':30,'140705':29,'140706':30,
'140707':29,'140708':30,'140709':29,'140710':30,'140711':29,'140712':30,'140801':30,'140802':29,'140803':30,'140804':29,
'140805':30,'140806':29,'140807':30,'140808':29,'140809':29,'140810':30,'140811':29,'140812':30,'140901':30,'140902':29,
'140903':30,'140904':30,'140905':29,'140906':30,'140907':29,'140908':30,'140909':29,'140910':29,'140911':30,'140912':29,
'141001':30,'141002':29,'141003':30,'141004':30,'141005':30,'141006':29,'141007':30,'141008':29,'141009':30,'141010':29,
'141011':29,'141012':30,'141101':29,'141102':30,'141103':29,'141104':30,'141105':30,'141106':29,'141107':30,'141108':30,
'141109':29,'141110':30,'141111':29,'141112':29,'141201':30,'141202':29,'141203':29,'141204':30,'141205':30,'141206':29,
'141207':30,'141208':30,'141209':30,'141210':29,'141211':30,'141212':29,'141301':29,'141302':30,'141303':29,'141304':29,
'141305':30,'141306':30,'141307':29,'141308':30,'141309':30,'141310':29,'141311':30,'141312':30,'141401':29,'141402':29,
'141403':30,'141404':29,'141405':29,'141406':30,'141407':29,'141408':30,'141409':30,'141410':30,'141411':29,'141412':30,
'141501':29,'141502':30,'141503':29,'141504':30,'141505':29,'141506':29,'141507':30,'141508':29,'141509':30,'141510':30,
'141511':29,'141512':30,'141601':30,'141602':29,'141603':30,'141604':29,'141605':30,'141606':29,'141607':30,'141608':29,
'141609':29,'141610':30,'141611':29,'141612':30,'141701':30,'141702':29,'141703':30,'141704':29,'141705':30,'141706':30,
'141707':29,'141708':30,'141709':29,'141710':30,'141711':29,'141712':29,'141801':30,'141802':29,'141803':30,'141804':29,
'141805':30,'141806':30,'141807':30,'141808':29,'141809':30,'141810':29,'141811':30,'141812':29,'141901':29,'141902':30,
'141903':29,'141904':30,'141905':29,'141906':30,'141907':30,'141908':29,'141909':30,'141910':30,'141911':29,'141912':30,
'142001':29,'142002':30,'142003':29,'142004':29,'142005':30,'142006':29,'142007':30,'142008':30,'142009':30,'142010':30,
'142011':29,'142012':30,'142101':29,'142102':29,'142103':30,'142104':29,'142105':29,'142106':29,'142107':30,'142108':30,
'142109':30,'142110':30,'142111':29,'142112':30,'142201':30,'142202':29,'142203':29,'142204':30,'142205':29,'142206':29,
'142207':29,'142208':30,'142209':30,'142210':30,'142211':29,'142212':30,'142301':30,'142302':29,'142303':30,'142304':29,
'142305':30,'142306':29,'142307':29,'142308':30,'142309':29,'142310':30,'142311':29,'142312':30,'142401':30,'142402':29,
'142403':30,'142404':30,'142405':29,'142406':30,'142407':29,'142408':29,'142409':30,'142410':29,'142411':30,'142412':29,
'142501':30,'142502':29,'142503':30,'142504':30,'142505':29,'142506':30,'142507':29,'142508':30,'142509':30,'142510':29,
'142511':30,'142512':29,'142601':29,'142602':30,'142603':29,'142604':30,'142605':29,'142606':30,'142607':30,'142608':29,
'142609':30,'142610':30,'142611':29,'142612':30,'142701':29,'142702':29,'142703':30,'142704':29,'142705':30,'142706':29,
'142707':30,'142708':30,'142709':29,'142710':30,'142711':30,'142712':29,'142801':30,'142802':29,'142803':29,'142804':30,
'142805':29,'142806':29,'142807':30,'142808':30,'142809':30,'142810':29,'142811':30,'142812':30,'142901':29,'142902':30,
'142903':29,'142904':29,'142905':30,'142906':29,'142907':29,'142908':30,'142909':30,'142910':29,'142911':30,'142912':30,
'143001':29,'143002':30,'143003':30,'143004':29,'143005':29,'143006':30,'143007':29,'143008':30,'143009':29,'143010':30,
'143011':29,'143012':30,'143101':29,'143102':30,'143103':30,'143104':29,'143105':30,'143106':29,'143107':30,'143108':29,
'143109':30,'143110':29,'143111':29,'143112':30,'143201':29,'143202':30,'143203':30,'143204':30,'143205':29,'143206':30,
'143207':29,'143208':30,'143209':29,'143210':30,'143211':29,'143212':29,'143301':30,'143302':29,'143303':30,'143304':30,
'143305':29,'143306':30,'143307':30,'143308':29,'143309':30,'143310':29,'143311':30,'143312':29,'143401':29,'143402':30,
'143403':29,'143404':30,'143405':29,'143406':30,'143407':30,'143408':29,'143409':30,'143410':30,'143411':29,'143412':29,
'143501':30,'143502':29,'143503':30,'143504':29,'143505':30,'143506':29,'143507':30,'143508':29,'143509':30,'143510':30,
'143511':29,'143512':30,'143601':29,'143602':30,'143603':29,'143604':30,'143605':29,'143606':30,'143607':29,'143608':30,
'143609':29,'143610':30,'143611':29,'143612':30,'143701':30,'143702':29,'143703':30,'143704':30,'143705':29,'143706':29,
'143707':30,'143708':29,'143709':30,'143710':29,'143711':29,'143712':30,'143801':30,'143802':29,'143803':30,'143804':30,
'143805':30,'143806':29,'143807':29,'143808':30,'143809':29,'143810':29,'143811':30,'143812':29,'143901':30,'143902':29,
'143903':30,'143904':30,'143905':30,'143906':29,'143907':30,'143908':29,'143909':30,'143910':29,'143911':29,'143912':30,
'144001':29,'144002':30,'144003':29,'144004':30,'144005':30,'144006':30,'144007':29,'144008':30,'144009':29,'144010':30,
'144011':29,'144012':29,'144101':30,'144102':29,'144103':30,'144104':29,'144105':30,'144106':30,'144107':29,'144108':30,
'144109':30,'144110':29,'144111':30,'144112':29,'144201':29,'144202':30,'144203':29,'144204':30,'144205':29,'144206':30,
'144207':29,'144208':30,'144209':30,'144210':29,'144211':30,'144212':29,'144301':30,'144302':29,'144303':30,'144304':29,
'144305':30,'144306':29,'144307':30,'144308':29,'144309':30,'144310':29,'144311':30,'144312':30,'144401':29,'144402':30,
'144403':29,'144404':30,'144405':30,'144406':29,'144407':29,'144408':30,'144409':29,'144410':30,'144411':29,'144412':30,
'144501':29,'144502':30,'144503':30,'144504':30,'144505':29,'144506':30,'144507':29,'144508':29,'144509':30,'144510':29,
'144511':29,'144512':30,'144601':29,'144602':30,'144603':30,'144604':30,'144605':29,'144606':30,'144607':30,'144608':29,
'144609':29,'144610':30,'144611':29,'144612':29,'144701':30,'144702':29,'144703':30,'144704':30,'144705':30,'144706':29,
'144707':30,'144708':29,'144709':30,'144710':29,'144711':30,'144712':29,'144801':29,'144802':30,'144803':29,'144804':30,
'144805':30,'144806':29,'144807':30,'144808':30,'144809':29,'144810':30,'144811':29,'144812':30,'144901':29,'144902':29,
'144903':30,'144904':29,'144905':30,'144906':29,'144907':30,'144908':30,'144909':29,'144910':30,'144911':30,'144912':29,
'145001':30,'145002':29,'145003':30,'145004':29,'145005':29,'145006':30,'145007':29,'145008':30,'145009':29,'145010':30,
'145011':30,'145012':29,'145101':30,'145102':30,'145103':29,'145104':30,'145105':29,'145106':29,'145107':30,'145108':29,
'145109':30,'145110':29,'145111':30,'145112':29,'145201':30,'145202':30,'145203':30,'145204':29,'145205':30,'145206':29,
'145207':29,'145208':30,'145209':29,'145210':30,'145211':29,'145212':30,'145301':29,'145302':30,'145303':30,'145304':30,
'145305':29,'145306':29,'145307':30,'145308':29,'145309':30,'145310':29,'145311':30,'145312':29,'145401':29,'145402':30,
'145403':30,'145404':30,'145405':29,'145406':30,'145407':29,'145408':30,'145409':29,'145410':30,'145411':29,'145412':30,
'145501':29,'145502':29,'145503':30,'145504':30,'145505':29,'145506':30,'145507':29,'145508':30,'145509':30,'145510':29,
'145511':30,'145512':29,'145601':30,'145602':29,'145603':29,'145604':30,'145605':29,'145606':30,'145607':29,'145608':30,
'145609':30,'145610':30,'145611':29,'145612':30,'145701':29,'145702':30,'145703':29,'145704':29,'145705':30,'145706':29,
'145707':29,'145708':30,'145709':30,'145710':29,'145711':30,'145712':30,'145801':30,'145802':29,'145803':30,'145804':29,
'145805':29,'145806':30,'145807':29,'145808':29,'145809':30,'145810':30,'145811':29,'145812':30,'145901':30,'145902':30,
'145903':29,'145904':30,'145905':29,'145906':29,'145907':30,'145908':29,'145909':29,'145910':30,'145911':30,'145912':29,
'146001':30,'146002':30,'146003':29,'146004':30,'146005':29,'146006':30,'146007':29,'146008':30,'146009':29,'146010':29,
'146011':30,'146012':30,'146101':29,'146102':30,'146103':29,'146104':30,'146105':30,'146106':29,'146107':30,'146108':29,
'146109':30,'146110':29,'146111':30,'146112':29,'146201':30,'146202':29,'146203':30,'146204':29,'146205':30,'146206':29,
'146207':30,'146208':29,'146209':30,'146210':30,'146211':29,'146212':30,'146301':29,'146302':30,'146303':29,'146304':29,
'146305':30,'146306':29,'146307':30,'146308':30,'146309':29,'146310':30,'146311':30,'146312':29,'146401':30,'146402':29,
'146403':30,'146404':29,'146405':29,'146406':30,'146407':29,'146408':30,'146409':29,'146410':30,'146411':30,'146412':30,
'146501':29,'146502':30,'146503':29,'146504':30,'146505':29,'146506':29,'146507':30,'146508':29,'146509':29,'146510':30,
'146511':30,'146512':30,'146601':30,'146602':29,'146603':30,'146604':29,'146605':30,'146606':29,'146607':29,'146608':30,
'146609':29,'146610':30,'146611':29,'146612':30,'146701':30,'146702':29,'146703':30,'146704':30,'146705':29,'146706':30,
'146707':29,'146708':29,'146709':30,'146710':29,'146711':30,'146712':29,'146801':30,'146802':29,'146803':30,'146804':30,
'146805':29,'146806':30,'146807':29,'146808':30,'146809':29,'146810':30,'146811':29,'146812':30,'146901':29,'146902':29,
'146903':30,'146904':30,'146905':29,'146906':30,'146907':30,'146908':29,'146909':30,'146910':30,'146911':29,'146912':29,
'147001':30,'147002':29,'147003':29,'147004':30,'147005':30,'147006':29,'147007':30,'147008':29,'147009':30,'147010':30,
'147011':30,'147012':29,'147101':29,'147102':30,'147103':29,'147104':29,'147105':30,'147106':29,'147107':30,'147108':30,
'147109':29,'147110':30,'147111':30,'147112':29,'147201':30,'147202':29,'147203':30,'147204':29,'147205':30,'147206':29,
'147207':29,'147208':30,'147209':29,'147210':30,'147211':30,'147212':29,'147301':30,'147302':29,'147303':30,'147304':30,
'147305':29,'147306':30,'147307':29,'147308':29,'147309':30,'147310':29,'147311':30,'147312':29,'147401':30,'147402':30,
'147403':29,'147404':30,'147405':30,'147406':29,'147407':30,'147408':29,'147409':29,'147410':30,'147411':29,'147412':30,
'147501':29,'147502':30,'147503':29,'147504':30,'147505':30,'147506':30,'147507':29,'147508':30,'147509':29,'147510':29,
'147511':30,'147512':29,'147601':29,'147602':30,'147603':29,'147604':30,'147605':30,'147606':30,'147607':29,'147608':30,
'147609':30,'147610':29,'147611':29,'147612':30,'147701':29,'147702':29,'147703':30,'147704':29,'147705':30,'147706':30,
'147707':29,'147708':30,'147709':30,'147710':30,'147711':29,'147712':29,'147801':30,'147802':29,'147803':29,'147804':30,
'147805':29,'147806':30,'147807':30,'147808':29,'147809':30,'147810':30,'147811':29,'147812':30,'147901':29,'147902':30,
'147903':29,'147904':29,'147905':30,'147906':29,'147907':30,'147908':29,'147909':30,'147910':30,'147911':29,'147912':30,
'148001':29,'148002':30,'148003':30,'148004':29,'148005':29,'148006':30,'148007':29,'148008':30,'148009':29,'148010':30,
'148011':29,'148012':30,'148101':29,'148102':30,'148103':30,'148104':29,'148105':30,'148106':30,'148107':29,'148108':30,
'148109':29,'148110':29,'148111':30,'148112':29,'148201':30,'148202':29,'148203':30,'148204':30,'148205':29,'148206':30,
'148207':30,'148208':29,'148209':30,'148210':29,'148211':29,'148212':30,'148301':29,'148302':29,'148303':30,'148304':30,
'148305':29,'148306':30,'148307':30,'148308':30,'148309':29,'148310':30,'148311':29,'148312':29,'148401':30,'148402':29,
'148403':29,'148404':30,'148405':30,'148406':29,'148407':30,'148408':30,'148409':29,'148410':30,'148411':30,'148412':29,
'148501':29,'148502':30,'148503':29,'148504':29,'148505':30,'148506':30,'148507':29,'148508':30,'148509':30,'148510':29,
'148511':30,'148512':30,'148601':29,'148602':29,'148603':30,'148604':29,'148605':30,'148606':29,'148607':30,'148608':29,
'148609':30,'148610':29,'148611':30,'148612':30,'148701':29,'148702':30,'148703':29,'148704':30,'148705':29,'148706':30,
'148707':29,'148708':29,'148709':30,'148710':29,'148711':30,'148712':30,'148801':29,'148802':30,'148803':30,'148804':29,
'148805':30,'148806':29,'148807':30,'148808':29,'148809':29,'148810':30,'148811':29,'148812':30,'148901':29,'148902':30,
'148903':30,'148904':30,'148905':29,'148906':30,'148907':29,'148908':30,'148909':29,'148910':29,'148911':30,'148912':29,
'149001':30,'149002':29,'149003':30,'149004':30,'149005':29,'149006':30,'149007':30,'149008':29,'149009':30,'149010':29,
'149011':29,'149012':30,'149101':29,'149102':30,'149103':29,'149104':30,'149105':29,'149106':30,'149107':30,'149108':29,
'149109':30,'149110':29,'149111':30,'149112':30,'149201':29,'149202':29,'149203':30,'149204':29,'149205':30,'149206':29,
'149207':30,'149208':29,'149209':30,'149210':30,'149211':29,'149212':30,'149301':30,'149302':29,'149303':29,'149304':30,
'149305':29,'149306':30,'149307':29,'149308':29,'149309':30,'149310':30,'149311':29,'149312':30,'149401':30,'149402':30,
'149403':29,'149404':29,'149405':30,'149406':29,'149407':29,'149408':30,'149409':29,'149410':30,'149411':29,'149412':30,
'149501':30,'149502':30,'149503':29,'149504':30,'149505':29,'149506':30,'149507':29,'149508':29,'149509':30,'149510':29,
'149511':30,'149512':29,'149601':30,'149602':30,'149603':30,'149604':29,'149605':30,'149606':29,'149607':30,'149608':29,
'149609':29,'149610':30,'149611':29,'149612':30,'149701':29,'149702':30,'149703':30,'149704':29,'149705':30,'149706':30,
'149707':29,'149708':29,'149709':30,'149710':29,'149711':30,'149712':29,'149801':30,'149802':29,'149803':30,'149804':29,
'149805':30,'149806':30,'149807':29,'149808':30,'149809':29,'149810':30,'149811':29,'149812':30,'149901':29,'149902':30,
'149903':29,'149904':30,'149905':29,'149906':30,'149907':29,'149908':30,'149909':29,'149910':30,'149911':30,'149912':29,
'150001':30,'150002':30,'150003':29,'150004':29,'150005':30,'150006':29,'150007':29,'150008':30,'150009':29,'150010':30,
'150011':30,'150012':29}

def hij_less_than_equal(hij1,hij2):
    # print('hiiij les than or equal',hij1,hij2)
    # print(hij1.year,hij1.month,hij1.day)
    # print(hij2.year,hij2.month,hij2.day)
    g1=create_greg_from_hij(hij1)
    g2=create_greg_from_hij(hij2)
    # print('gggggggggggg',g1,g2)
    if g1<=g2:
        return True
    return False

def hij_less_than(hij1,hij2):
    print('hiiij',hij1,hij2)
    # print(hij1.year,hij1.month,hij1.day)
    # print(hij2.year,hij2.month,hij2.day)
    g1=create_greg_from_hij(hij1)
    g2=create_greg_from_hij(hij2)
    # print('gggggggggggg',g1,g2)
    if g1<g2:
        return True
    return False

def get_work_ratio(frame_start,frame_end,work_start,work_end):
    # print('work ratio',frame_start,frame_end,work_start,work_end)
    return (work_end-work_start).days/(frame_end-frame_start).days

def split_by_date_and_duration_period2(assign_date,start,end,duration):
    start_hij=create_hij_from_greg(start)
    end_hij=create_hij_from_greg(end)
    #get first assigning date before leave start
    current_start,dont_care=get_year_boundries(assign_date)
    current_start=create_hij_from_greg(current_start)
    hij_check=create_hij_from_greg(sub_duration(start,0,duration,0))
    print('current start',current_start)
    while hij_less_than_equal(current_start,hij_check) :
        # print('inside less than or equal loop to find first one')
        current_start=create_hij_from_greg(add_duration(create_greg_from_hij(current_start),0,duration,0))
    #segment leave to durations
    slices=[]
    current_start=create_greg_from_hij(current_start)
    print('current start 2',current_start)
    current_end = add_duration(current_start, 0, duration, 0)
    print('duration added',current_end)
    current_end=sub_duration(current_end,0,0,1)
    print('duratio subtracted',current_end)
    current_end = create_hij_from_greg(current_end)
    print('current end and end hij are',current_end,end_hij)
    while hij_less_than(current_end,end_hij):
        # print(current_start)
        slice=((current_start),create_greg_from_hij(current_end),create_greg_from_hij(start_hij),create_greg_from_hij(current_end))
        slices.append(slice)
        current_start=add_duration(current_start,0,duration,0)
        current_end = add_duration(current_start, 0, duration, 0)
        current_end = sub_duration(current_end, 0, 0, 1)
        current_end = create_hij_from_greg(current_end)
        start_hij=create_hij_from_greg(current_start)

    slice = ((current_start), create_greg_from_hij(current_end), create_greg_from_hij(start_hij),
             create_greg_from_hij(end_hij))
    slices.append(slice)
    return slices
def split_by_date_and_duration_period(assign_date,start,end,duration):
    start_hij=create_hij_from_greg(start)
    end_hij=create_hij_from_greg(end)
    #get first assigning date before leave start
    # what is this blame : karim ???!!!
    current_start,dont_care=_get_last_promotion_dateget_year_boundries(start)

    #segment leave to durations
    slices=[]
    current_end = add_duration(current_start, 0, duration, 0)
    # print('duration added',current_end)
    current_end=sub_duration(current_end,0,0,1)
    # print('duratio subtracted',current_end)
    current_end = create_hij_from_greg(current_end)
    # print('current end and end hij are',current_end,end_hij)
    while hij_less_than(current_end,end_hij):
        # print(current_start)
        slice=((current_start),create_greg_from_hij(current_end),create_greg_from_hij(start_hij),create_greg_from_hij(current_end))
        slices.append(slice)
        current_start=add_duration(current_start,0,duration,0)
        current_end = add_duration(current_start, 0, duration, 0)
        current_end = sub_duration(current_end, 0, 0, 1)
        current_end = create_hij_from_greg(current_end)
        start_hij=create_hij_from_greg(current_start)

    slice = ((current_start), create_greg_from_hij(current_end), create_greg_from_hij(start_hij),
             create_greg_from_hij(end_hij))
    slices.append(slice)
    return slices

def split_by_date_and_duration_last_leave(date,duration,last_leave_date):

    # print('date is not',date)
    current_start=create_hij_from_greg(date)
    end_last_leave_hij=create_hij_from_greg(last_leave_date)
    # print('current start after conversion is ',current_start)
    #segment leave to durations
    slices=[]
    current_end = add_duration(create_greg_from_hij(current_start), 0, duration, 0)
    # print('duration added',current_end)
    current_end=sub_duration(current_end,0,0,1)
    # print('duratio subtracted',current_end)
    current_end = create_hij_from_greg(current_end)
    while hij_less_than(current_end,end_last_leave_hij):
        # print(current_start)
        slice=(create_greg_from_hij(current_start),create_greg_from_hij(current_end))
        slices.append(slice)
        current_start=add_duration(create_greg_from_hij(current_start),0,duration,0)
        current_end = add_duration(current_start, 0, duration, 0)
        current_end = sub_duration(current_end, 0, 0, 1)
        current_end = create_hij_from_greg(current_end)
        current_start=create_hij_from_greg(current_start)

    slice = (create_greg_from_hij(current_start), create_greg_from_hij(current_end))
    slices.append(slice)
    return slices


def split_by_date_and_duration(date,start,end,duration):
    ###option2
    start_hij = create_hij_from_greg(start)
    end_hij = create_hij_from_greg(end)
    current_start = create_hij_from_greg(date)


    ###option one
    # print('date is not',date)
    start_hij=create_hij_from_greg(start)
    end_hij=create_hij_from_greg(end)
    current_start=create_hij_from_greg(date)
    # print('current start after conversion is ',current_start)
    #get first assigning date before leave start
    while hij_less_than_equal(current_start,create_hij_from_greg(sub_duration(start,0,duration,0))):
        # print('inside less than or equal loop to find first one')
        current_start=create_hij_from_greg(add_duration(create_greg_from_hij(current_start),0,duration,0))
    # print('current start is 1',current_start)
    #segment leave to durations
    slices=[]
    current_end = add_duration(create_greg_from_hij(current_start), 0, duration, 0)
    # print('duration added',current_end)
    current_end=sub_duration(current_end,0,0,1)
    # print('duratio subtracted',current_end)
    current_end = create_hij_from_greg(current_end)
    # print('current end and end hij are',current_end,end_hij)
    while hij_less_than(current_end,end_hij):
        # print(current_start)
        slice=(create_greg_from_hij(current_start),create_greg_from_hij(current_end),create_greg_from_hij(start_hij),create_greg_from_hij(current_end))
        slices.append(slice)
        current_start=add_duration(create_greg_from_hij(current_start),0,duration,0)
        current_end = add_duration(current_start, 0, duration, 0)
        current_end = sub_duration(current_end, 0, 0, 1)
        current_end = create_hij_from_greg(current_end)
        start_hij=create_hij_from_greg(current_start)
        current_start=create_hij_from_greg(current_start)

    slice = (create_greg_from_hij(current_start), create_greg_from_hij(current_end), create_greg_from_hij(start_hij),
             create_greg_from_hij(end_hij))
    slices.append(slice)
    return slices


def split_dates_to_years(start,end,duration):
    start_hij=create_hij_from_greg(start)
    end_hij=create_hij_from_greg(end)

    current_start,current_end=get_year_boundries(start)
    current_end = add_duration(create_greg_from_hij(current_start), 0, duration, 0)
    # print('duration added', current_end)
    current_end = sub_duration(current_end, 0, 0, 1)


    current_range_start=start
    # print('after current range start',current_range_start)
    result_ranges=[]
    count=1
    while hij_less_than(current_end, end_hij):
        # print(current_start)
        slice = (
        create_greg_from_hij(current_start), create_greg_from_hij(current_end), create_greg_from_hij(start_hij),
        create_greg_from_hij(current_end))
        result_ranges.append(slice)
        current_start = add_duration(create_greg_from_hij(current_start), 0, duration, 0)
        current_end = add_duration(current_start, 0, duration, 0)
        current_end = sub_duration(current_end, 0, 0, 1)
        current_end = create_hij_from_greg(current_end)
        start_hij = create_hij_from_greg(current_start)
        current_start = create_hij_from_greg(current_start)

    slice = (create_greg_from_hij(current_start), create_greg_from_hij(current_end), create_greg_from_hij(start_hij),
             create_greg_from_hij(end_hij))
    result_ranges.append(slice)
    return result_ranges


def create_greg_from_hij(hij_date):
    # print('create grep from hij',hij_date)
    # print(hij_date.year_gr,hij_date.month_gr,hij_date.day_gr)
    if isinstance(hij_date,HijriDate):
        return date(hij_date.year_gr,hij_date.month_gr,hij_date.day_gr)
    return False

def get_today():
    today=date.today()
    return create_hij_from_greg(today)


def create_hij_from_greg(greg_date):
    # print('inside create hij from greg',greg_date)
    if isinstance(greg_date,date):
        return HijriDate(greg_date.year,greg_date.month,greg_date.day,gr=True)
    return False

def get_last_day_in_hijri_month(year,month):
    key = str(year) + str(month).zfill(2)
    return month_ending[key]

def get_year_boundries(in_date):
    tod_hijri = create_hij_from_greg(in_date)
    # print(tod_hijri)
    first_day = HijriDate(tod_hijri.year, 1, 1)
    last_day = HijriDate(tod_hijri.year, 12, get_last_day_in_hijri_month(tod_hijri.year, 12))
    first_day_gr = date(first_day.year_gr, first_day.month_gr, first_day.day_gr)
    last_day_gr = date(last_day.year_gr, last_day.month_gr, last_day.day_gr)
    return first_day_gr, last_day_gr

def get_year_boundries_hij(tod_hijri):
    first_day = HijriDate(tod_hijri.year, 1, 1)
    last_day = HijriDate(tod_hijri.year, 12, get_last_day_in_hijri_month(tod_hijri.year, 12))
    first_day_gr = date(first_day.year_gr, first_day.month_gr, first_day.day_gr)
    last_day_gr = date(last_day.year_gr, last_day.month_gr, last_day.day_gr)
    return first_day_gr, last_day_gr

def get_current_hijri_year():
    tod=date.today()
    tod_hijri=create_hij_from_greg(tod)
    first_day=HijriDate(tod_hijri.year,1,1)
    last_day=HijriDate(tod_hijri.year,12,get_last_day_in_hijri_month(tod_hijri.year,12))
    first_day_gr=date(first_day.year_gr,first_day.month_gr,first_day.day_gr)
    last_day_gr=date(last_day.year_gr,last_day.month_gr,last_day.day_gr)
    return first_day_gr,last_day_gr

def is_valid_hijri_date(day,month,year):
    if not day or not month or not year:
        return False
    key=str(year)+str(month).zfill(2)
    if key in month_ending and month_ending[key] >= day:
        return True
    return False

def add_duration(date,year=0,month=0,day=0):
    # print('inside add duration date is',date)
    if not date:
        # print('no date')
        return None
    d1=add_hijri_duration(date,year,'year')
    d2=add_hijri_duration(d1,month,'month')
    d3=add_hijri_duration(d2,day,'day')
    return d3

def add_hijri_duration(date_value,duration,duration_type):
    if not isinstance(date_value,date):
        # print('not valid date format')
        return None
    if duration_type=='day':
        date_value=date_value+timedelta(days=duration)
        return date_value
    if duration_type=='month':
        # print('adding month')
        if duration>11:
            years=int(duration/12)
            date_value=add_hijri_duration(date_value, years, 'year')
            duration=duration%12
        hij=HijriDate(date_value.year,date_value.month,date_value.day,gr=True)
        # print(hij.month)
        total_months=hij.month+duration
        div=0
        if total_months>12:
            div=int(total_months/12)
        rem=total_months%12
        if rem==0:
            rem=12
        hij_year=hij.year+div
        hij_month=rem
        if hij_month==0:
            hij_month=12
        if is_valid_hijri_date(hij.day,hij_month,hij_year):
            # print('valid check 1',hij.day,hij_month,hij_year)
            res_date=HijriDate(hij_year,hij_month,hij.day)
            return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
        else:
            if is_valid_hijri_date(hij.day-1,hij_month,hij_year):
                res_date=HijriDate(hij_year,hij_month,hij.day-1)
                return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
            else:
                if is_valid_hijri_date(hij.day-2,hij_month,hij_year):
                    res_date=HijriDate(hij_year,hij_month,hij.day-2)
                    return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
    if duration_type=='year':
        hij = HijriDate(date_value.year, date_value.month, date_value.day, gr=True)
        hij_year=hij.year+duration
        if is_valid_hijri_date(hij.day, hij.month, hij_year):
            res_date = HijriDate(hij_year, hij.month, hij.day)
            return date(res_date.year_gr, res_date.month_gr, res_date.day_gr)
        else:
            if is_valid_hijri_date(hij.day-1,hij.month,hij_year):
                res_date=HijriDate(hij_year,hij.month,hij.day-1)
                return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)




    return None

def sub_duration(date,year=0,month=0,day=0):
    if not date:
        return None

    d1=sub_hijri_duration(date,day,'day')
    d2=sub_hijri_duration(d1,month,'month')

    d3=sub_hijri_duration(d2,year,'year')
    return d3

def sub_hijri_duration(date_value,duration,duration_type):
    if not isinstance(date_value,date):
        return None
    if duration_type=='day':
        date_value=date_value-timedelta(days=duration)
        return date_value
    if duration_type=='month':
        hij=HijriDate(date_value.year,date_value.month,date_value.day,gr=True)
        # total_months=hij.month-duration
        div=int(duration/12)
        hij_year=hij.year-div
        rem=duration%12
        hij_month=-1
        if rem<hij.month:
            hij_month=hij.month-rem
        else:
            hij_year=hij_year-1
            hij_month=12-(rem-hij.month)
        if hij_month==0:
            hij_month=12
        if is_valid_hijri_date(hij.day,hij_month,hij_year):
            res_date=HijriDate(hij_year,hij_month,hij.day)
            return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
        else:
            if is_valid_hijri_date(hij.day-1,hij_month,hij_year):
                res_date=HijriDate(hij_year,hij_month,hij.day-1)
                return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
            else:
                if is_valid_hijri_date(hij.day-2,hij_month,hij_year):
                    res_date=HijriDate(hij_year,hij_month,hij.day-2)
                    return date(res_date.year_gr,res_date.month_gr,res_date.day_gr)
    if duration_type == 'year':
        hij = HijriDate(date_value.year, date_value.month, date_value.day, gr=True)
        hij_year = hij.year - duration
        if is_valid_hijri_date(hij.day, hij.month, hij_year):
            res_date = HijriDate(hij_year, hij.month, hij.day)
            return date(res_date.year_gr, res_date.month_gr, res_date.day_gr)
        else:
            if is_valid_hijri_date(hij.day - 1, hij.month, hij_year):
                res_date = HijriDate(hij_year, hij.month, hij.day - 1)
                return date(res_date.year_gr, res_date.month_gr, res_date.day_gr)
    return None


def hijri_date_diff_month(date1,date2):
    if isinstance(date1,date) and isinstance(date2,date):
        y,m,d=hijri_date_diff(date1,date2)
        return (y*12)+(m)
    return False

def hijri_date_diff(date1,date2):
    if isinstance(date1,date) and isinstance(date2,date):
        delta=date2-date1

        d1=create_hij_from_greg(date1)
        d2=create_hij_from_greg(date2)
        month_diff=0
        year_diff=d2.year-d1.year
        day_diff=0
        if d2.month>d1.month:
            if d2.day>=d1.day:
                month_diff=d2.month-d1.month
                day_diff=d2.day-d1.day
            else:
                update_month=d2.month-1
                if update_month==0:
                    update_month=12
                if is_valid_hijri_date(d2.day,update_month,d1.year):
                    diff_in_prev_month=month_ending[str(d2.year)+str(update_month).zfill(2)]-d1.day
                    day_diff=diff_in_prev_month+d2.day
                    month_diff=(d2.month-d1.month)-1
        if d2.month==d1.month:
            if d2.day>=d1.day:
                month_diff=d2.month-d1.month
                day_diff=d2.day-d1.day
            else:
                update_month = d2.month - 1
                if update_month == 0:
                    update_month = 12
                if is_valid_hijri_date(d2.day,update_month,d1.year):
                    diff_in_prev_month=month_ending[str(d2.year)+str(update_month).zfill(2)]-d1.day
                    day_diff=diff_in_prev_month+d2.day
                    month_diff=11
                    year_diff-=1

        if d2.month<d1.month:
            if d2.day>=d1.day:
                month_diff=(12-d1.month)+d2.month
                year_diff-=1
                day_diff=d2.day-d1.day
            else:
                update_month = d2.month - 1
                if update_month == 0:
                    update_month = 12
                if is_valid_hijri_date(d2.day,update_month,d1.year):
                    diff_in_prev_month=month_ending[str(d2.year)+str(update_month).zfill(2)]-d1.day
                    day_diff=diff_in_prev_month+d2.day
                    month_diff = ((12 - d1.month) + d2.month)-1
                    year_diff-=1
        return year_diff,month_diff,day_diff



# print(hijri_date_diff(date(2017,2,1),date.today()))

# d=date(2019,7,3)
# print(sub_hijri_duration(d,1,'month'
# hijri_date_diff(date(1989,6,14),date.today())
# start=0
# count=1
# sum=0
# year=1270
# month=1
# while start < len(month_ending):
#     start+=1
#     sum+=month_ending[str(year)+str(month).zfill(2)]
#     month+=1
#     count+1
#     if month==13:
#         month=1
#         year+=1
#         print(sum)
#         sum=0
