<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Header Template -->
    <template id="asset_handover_report.asset_handover_report_header">
        <div style=" width: 100%; margin-bottom: 10px;">
            <table style="width:100%;border: 1px solid #000; border-collapse: collapse;">
                <tr>
                    <td class='p-1' style="width: 33.33%; text-align: center; vertical-align: middle;">
                        <img t-if="request.env.company.logo"
                             t-att-src="image_data_uri(request.env.company.logo)"
                             style="max-height: 80px; max-width: 130px; object-fit: contain;"/>
                    </td>
                    <td class='p-1' style="width: 33.33%;  vertical-align: top; ">
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>Form No:</span>
                            <span t-esc="doc.form_no"/>
                        </div>
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>Version:</span>
                            <span>1.1</span>
                        </div>
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>Date:</span>
                            <span t-esc="doc.handover_date and doc.handover_date.strftime('%b %d, %Y') or context_timestamp(datetime.datetime.now()).strftime('%b %d, %Y')"/>
                        </div>
                        <div class='p-1'
                             style="border: 1px solid #000;  display: flex; justify-content: space-between;">
                            <span>Department:</span>
                            <span>Information Technology</span>
                        </div>
                    </td>
                    <td class='p-1' style="width: 33.33%;  vertical-align: top; ">
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>Asset Handover ID:</span>
                            <span t-esc="doc.asset_handover_no"/>
                        </div>
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>References:</span>
                            <span>ISO 9001, ISO 27001</span>
                        </div>
                        <div class='p-1'
                             style="border: 1px solid #000;  margin-bottom: 2px; display: flex; justify-content: space-between;">
                            <span>Location:</span>
                            <span>Head Office, Riyadh</span>
                        </div>
                        <div class='p-1' style="border: 1px solid #000; ">
                            <span>ISMS-POL-013-Asset Management Policy</span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Footer Template -->
    <template id="asset_handover_report.asset_handover_report_footer">
        <div style="border-top: 2px solid #000; padding:0px 20px">
            <div class="row" style="display: flex; align-items: center; padding: 5px;">
                <div class="col-6" style="flex: 1; width: 70%;">
                    <span style="color:#1A3C35; font-weight:bold; font-size: 14px;">
                        Classification:
                        <span style="color:#8B98ED; font-size: 14px;">Company Asset – Internal</span>
                    </span>
                </div>
                <div class="col-6 text-right" style="flex: 0 0 30%; text-align: center;">
                    <span style="color:#1A3C35; font-size: 12px;"
                          t-esc="context_timestamp(datetime.datetime.now()).strftime('%B %d, %Y')"/>
                </div>
            </div>
        </div>
    </template>

    <!-- Main Template -->
    <template id="asset_handover_report.employee_device_template">
        <t t-foreach="docs" t-as="doc">
            <t t-call="web.html_container">
                <t t-call="web.basic_layout">
                    <style>
                        @font-face { font-family: 'DroidKufiRegular';
                        src:
                        url('/asset_handover_report/static/src/fonts/DroidKufi-Regular.ttf')
                        format('truetype');}
                        .page{
                        <!--                            background-color:red;-->
                        position: relative;
                        z-index: 1;
                        }
                        .page::before {
                        content: "";
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: url('/asset_handover_report/static/src/img/watermark.jpeg')
                        no-repeat center center;
                        background-size: 50%;
                        opacity: 0.2;
                        <!--                        z-index: -1;-->
                        }
                    </style>
                    <div class="page">
                        <t t-call="asset_handover_report.asset_handover_report_header"/>

                        <!-- Recipient Information Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                            <thead>
                                <tr>
                                    <th colspan="4"
                                        style="background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        <span>Recipient Information</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class='p-1' style="width: 25%;">
                                        <span>Employee Name</span>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.employee_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.employee_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;text-align:right;">
                                        <span style="font-family:DroidKufiRegular">
                                            اسم الموظف
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class='p-1' style="width: 25%;">
                                        <span>Employee ID</span>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.identification_no or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.identification_no or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;text-align:right;">
                                        <span style="font-family:DroidKufiRegular">الرقم الوظيفي</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class='p-1' style="width: 25%;">
                                        <span>Department</span>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.department_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.department_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;text-align:right;">
                                        <span style="font-family:DroidKufiRegular">القسم</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class='p-1' style="width: 25%;">
                                        <span>Job Title</span>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.job_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;">
                                        <span t-esc="doc.job_id.name or ''"/>
                                    </td>
                                    <td class='p-1' style="width: 25%;text-align:right;">
                                        <span style="font-family:DroidKufiRegular">المسمى الوظيفي</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Device Information Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                            <thead>
                                <tr>
                                    <th colspan="5"
                                        style="background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        Device Information
                                    </th>
                                </tr>
                                <tr>
                                    <th style="width: 20%; font-weight: bold; text-align: center; padding: 5px; border: 1px solid #000;">
                                        Asset
                                    </th>
                                    <th style="width: 20%; font-weight: bold; text-align: center; padding: 5px; border: 1px solid #000;">
                                        Type
                                    </th>
                                    <th style="width: 20%; font-weight: bold; text-align: center; padding: 5px; border: 1px solid #000;">
                                        Model
                                    </th>
                                    <th style="width: 20%; font-weight: bold; text-align: center; padding: 5px; border: 1px solid #000;">
                                        Serial Number (S/N)
                                    </th>
                                    <th style="width: 20%; font-weight: bold; text-align: center; padding: 5px; border: 1px solid #000;">
                                        Asset Number
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="doc.device_line_ids" t-as="line">
                                    <td class='p-1 text-center border'
                                        t-esc="line.asset or ''"/>
                                    <td class='p-1 text-center border'
                                        t-esc="line.type or ''"/>
                                    <td class='p-1 text-center border'
                                        t-esc="line.model or ''"/>
                                    <td class='p-1 text-center border'
                                        t-esc="line.serial_number or ''"/>
                                    <td class='p-1 text-center border'
                                        t-esc="line.asset_number or ''"/>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Device Usage Policies Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                            <thead>
                                <tr>
                                    <th style="width:50%;background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        <span>Device Usage Policies:</span>
                                    </th>
                                    <th style="width:50%;background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        <span style="font-family:DroidKufiRegular">:سياسات الاستخدام للأجهزة</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-1">
                                        <span>Devices are issued based on work-related needs only.</span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يتم صرف الأجهزة بناءً على احتياجات
                                            العمل فقط
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-1">
                                        <span>Devices must be used for work purposes only.</span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يجب استخدام الأجهزة لأغراض العمل فقط
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-1">
                                        <span>The use of devices for personal purposes is strictly prohibited.</span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يمنع منعاً باتاً استخدام الأجهزة
                                            للأغراض
                                            الشخصية
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-1">
                                        <span>The management must be informed in case of any malfunction or damage.
                                        </span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يجب إبلاغ الإدارة في حالة حدوث أي
                                            عطل أو
                                            تلف
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-1">
                                        <span>Devices must be returned upon termination of employment or role change.
                                        </span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يجب إعادة الأجهزة عند إنهاء الخدمة
                                            أو تغيير الوظيفة
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-1">
                                        <span>All data and information related to job duties must be handed over to the
                                            relevant department before leaving the position.
                                        </span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">.يجب تسليم البيانات والمعلومات
                                            المرتبطة بالمهام الوظيفية للإدارة المختصة قبل ترك الوظيفة
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!--  Acknowledgment of Receipt Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                            <thead>
                                <tr>
                                    <th style="width:50%;background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        <span>Acknowledgment of Receipt:</span>
                                    </th>
                                    <th style="width:50%;background: #f8f8f8; text-align: center; padding: 10px; font-size: 17px; font-weight: bold; border: 1px solid #000;">
                                        <span style="font-family:DroidKufiRegular">:إقرار بالاستلام</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-1">
                                        <span>I, the undersigned, acknowledge the receipt of the mentioned device, and
                                            I commit to using it in accordance with the company's policies. I also
                                            agree to return it upon termination of employment or role change, and I
                                            take full responsibility for any loss or damage to it.
                                        </span>
                                    </td>
                                    <td class='p-1' style="text-align:right;">
                                        <span style="font-family:DroidKufiRegular">
                                            أقر أنا المذكور أعلاه باستلام الجهاز المذكور، وأتعهد باستخدامه وفقاً لسياسات
                                            الشركة كما ألتزم بإعادته في حال انتهاء العمل أو تغيير الوظيفة، وأتحمل
                                            المسؤولية الكاملة عن أي فقدان أو ضرر يحدث له
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Signature Section (No Border) -->
                        <div class="row" style="margin-bottom:30px;">
                            <div class="col-5" style="padding: 5px;">
                                <div style="font-family:DroidKufiRegular;text-align:right; margin-bottom: 5px;">
                                    :الموظف الذي تم منه الاستلام
                                </div>
                                <div style="margin-bottom: 5px; font-weight: bold;">
                                    Employee Handover the Device:
                                </div>
                                <div style="">
                                    <strong>Employee Name:</strong>
                                    <span t-esc="doc.handover_employee_id.name or ''"/>
                                </div>
                                <div style="">
                                    <strong>Date:</strong>
                                    <span t-esc="doc.handover_date and doc.handover_date.strftime('%b %d, %Y') or context_timestamp(datetime.datetime.now()).strftime('%b %d, %Y')"/>
                                </div>
                                <div style=" width: 180px; height: 15px; ">
                                    <strong>Signature:</strong>
                                </div>
                            </div>
                            <div class="col-2"></div>
                            <div class="col-5" style="padding: 5px;">
                                <div style="font-family:DroidKufiRegular;text-align:right; margin-bottom: 5px;">
                                    :الموظف المقر بالاستلام
                                </div>
                                <div style="margin-bottom: 5px; font-weight: bold;">
                                    Employee Acknowledging Receipt:
                                </div>
                                <div style="">
                                    <strong>Employee Name:</strong>
                                    <span t-esc="doc.employee_id.name or ''"/>
                                </div>
                                <div style="">
                                    <strong>Date:</strong>
                                    <span t-esc="doc.handover_date and doc.handover_date.strftime('%b %d, %Y') or context_timestamp(datetime.datetime.now()).strftime('%b %d, %Y')"/>
                                </div>
                                <div style=" width: 180px;  ">
                                    <strong>Signature:</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Footer -->
                        <t t-call="asset_handover_report.asset_handover_report_footer"/>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>